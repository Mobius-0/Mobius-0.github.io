{
    "version": "https://jsonfeed.org/version/1",
    "title": "Khala • All posts by \"应急响应\" tag",
    "description": "GLHF",
    "home_page_url": "https://mobius-0.github.io",
    "items": [
        {
            "id": "https://mobius-0.github.io/security/WebNote/Defense%20techniques/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/",
            "url": "https://mobius-0.github.io/security/WebNote/Defense%20techniques/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/",
            "title": "应急响应",
            "date_published": "2022-12-05T08:40:15.000Z",
            "content_html": "<h1 id=\"响应流程\"><a class=\"anchor\" href=\"#响应流程\">#</a> 响应流程</h1>\n<h2 id=\"事件发生\"><a class=\"anchor\" href=\"#事件发生\">#</a> 事件发生</h2>\n<p>运维监控人员、客服审核人员等发现问题，向上通报。</p>\n<h2 id=\"事件确认\"><a class=\"anchor\" href=\"#事件确认\">#</a> 事件确认</h2>\n<p>收集事件信息、分析网络活动相关程序，日志和数据，判断事件的严重性，评估出问题的严重等级，是否向上进行汇报等。</p>\n<h2 id=\"事件响应\"><a class=\"anchor\" href=\"#事件响应\">#</a> 事件响应</h2>\n<p>各部门通力合作，处理安全问题，具体解决问题，避免存在漏洞未修补、后门未清除等残留问题。</p>\n<h2 id=\"事件关闭\"><a class=\"anchor\" href=\"#事件关闭\">#</a> 事件关闭</h2>\n<p>处理完事件之后，需要关闭事件，并写出安全应急处理分析报告，完成整个应急过程。</p>\n<h1 id=\"事件分类\"><a class=\"anchor\" href=\"#事件分类\">#</a> 事件分类</h1>\n<ul>\n<li>\n<p>病毒、木马、蠕虫事件</p>\n</li>\n<li>\n<p>Web 服务器入侵事件</p>\n</li>\n<li>\n<p>第三方服务入侵事件</p>\n</li>\n<li>\n<p>系统入侵事件</p>\n<ul>\n<li>利用 Windows 漏洞攻击操作系统</li>\n</ul>\n</li>\n<li>\n<p>网络攻击事件</p>\n<ul>\n<li>DDoS / ARP 欺骗 / DNS 劫持等</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"分析方向\"><a class=\"anchor\" href=\"#分析方向\">#</a> 分析方向</h1>\n<h2 id=\"文件分析\"><a class=\"anchor\" href=\"#文件分析\">#</a> 文件分析</h2>\n<ul>\n<li>\n<p>基于变化的分析</p>\n<ul>\n<li>日期</li>\n<li>文件增改</li>\n<li>最近使用文件</li>\n</ul>\n</li>\n<li>\n<p>源码分析</p>\n<ul>\n<li>检查源码改动</li>\n<li>查杀 WebShell 等后门</li>\n</ul>\n</li>\n<li>\n<p>系统日志分析</p>\n</li>\n<li>\n<p>应用日志分析</p>\n<ul>\n<li>分析 User-Agent，e.g.  <code>awvs / burpsuite / w3af / nessus / openvas</code></li>\n<li>对每种攻击进行关键字匹配，e.g.  <code>select/alert/eval</code></li>\n<li>异常请求，连续的 404 或者 500</li>\n</ul>\n</li>\n<li>\n<p><code>md5sum</code>  检查常用命令二进制文件的哈希，检查是否被植入 rootkit</p>\n</li>\n</ul>\n<h2 id=\"进程分析\"><a class=\"anchor\" href=\"#进程分析\">#</a> 进程分析</h2>\n<ul>\n<li>\n<p>符合以下特征的进程</p>\n<ul>\n<li>CPU 或内存资源占用长时间过高</li>\n<li>没有签名验证信息</li>\n<li>没有描述信息的进程</li>\n<li>进程的路径不合法</li>\n</ul>\n</li>\n<li>\n<p>dump 系统内存进行分析</p>\n</li>\n<li>\n<p>正在运行的进程</p>\n</li>\n<li>\n<p>正在运行的服务</p>\n</li>\n<li>\n<p>父进程和子进程</p>\n</li>\n<li>\n<p>后台可执行文件的完整哈希</p>\n</li>\n<li>\n<p>已安装的应用程序</p>\n</li>\n<li>\n<p>运行着密钥或其他正在自动运行的持久化程序</p>\n</li>\n<li>\n<p>计划任务</p>\n</li>\n</ul>\n<h2 id=\"身份信息分析\"><a class=\"anchor\" href=\"#身份信息分析\">#</a> 身份信息分析</h2>\n<ul>\n<li>本地以及域账号用户</li>\n<li>异常的身份验证</li>\n<li>非标准格式的用户名</li>\n</ul>\n<h2 id=\"日志分析\"><a class=\"anchor\" href=\"#日志分析\">#</a> 日志分析</h2>\n<ul>\n<li>杀软检测记录</li>\n</ul>\n<h2 id=\"网络分析\"><a class=\"anchor\" href=\"#网络分析\">#</a> 网络分析</h2>\n<ul>\n<li>防火墙配置</li>\n<li>DNS 配置</li>\n<li>路由配置</li>\n<li>监听端口和相关服务</li>\n<li>最近建立的网络连接</li>\n<li>RDP / VPN / SSH 等会话</li>\n</ul>\n<h2 id=\"配置分析\"><a class=\"anchor\" href=\"#配置分析\">#</a> 配置分析</h2>\n<ul>\n<li>查看 Linux SE 等配置</li>\n<li>查看环境变量</li>\n<li>查看配套的注册表信息检索，SAM 文件</li>\n<li>内核模块</li>\n</ul>\n<h1 id=\"linux应急响应\"><a class=\"anchor\" href=\"#linux应急响应\">#</a> Linux 应急响应</h1>\n<h2 id=\"文件分析-2\"><a class=\"anchor\" href=\"#文件分析-2\">#</a> 文件分析</h2>\n<ul>\n<li>\n<p>最近使用文件</p>\n<ul>\n<li><code>find / -ctime -2</code></li>\n<li><code>C:\\Documents and Settings\\Administrator\\Recent</code></li>\n<li><code>C:\\Documents and Settings\\Default User\\Recent</code></li>\n<li><code>%UserProfile%\\Recent</code></li>\n</ul>\n</li>\n<li>\n<p>系统日志分析</p>\n<ul>\n<li>/var/log/</li>\n</ul>\n</li>\n<li>\n<p>重点分析位置</p>\n<ul>\n<li><code>/var/log/wtmp</code>  登录进入，退出，数据交换、关机和重启纪录</li>\n<li><code>/var/run/utmp</code>  有关当前登录用户的信息记录</li>\n<li><code>/var/log/lastlog</code>  文件记录用户最后登录的信息，可用 lastlog 命令来查看。</li>\n<li><code>/var/log/secure</code>  记录登入系统存取数据的文件，例如 pop3/ssh/telnet/ftp 等都会被记录。</li>\n<li><code>/var/log/cron</code>  与定时任务相关的日志信息</li>\n<li><code>/var/log/message</code>  系统启动后的信息和错误日志</li>\n<li><code>/var/log/apache2/access.log</code>  apache access log</li>\n<li><code>/etc/passwd</code>  用户列表</li>\n<li><code>/etc/init.d/</code>  开机启动项</li>\n<li><code>/etc/cron*</code>  定时任务</li>\n<li><code>/tmp</code>  临时目录</li>\n<li><code>~/.ssh</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"用户分析\"><a class=\"anchor\" href=\"#用户分析\">#</a> 用户分析</h2>\n<ul>\n<li><code>/etc/shadow</code>  密码登陆相关信息</li>\n<li><code>uptime</code>  查看用户登陆时间</li>\n<li><code>/etc/sudoers</code>  sudo 用户列表</li>\n</ul>\n<h2 id=\"进程分析-2\"><a class=\"anchor\" href=\"#进程分析-2\">#</a> 进程分析</h2>\n<ul>\n<li>\n<p><code>netstat -ano</code>  查看是否打开了可疑端口</p>\n</li>\n<li>\n<p><code>w</code>  命令，查看用户及其进程</p>\n</li>\n<li>\n<p>分析开机自启程序 / 脚本</p>\n<ul>\n<li><code>/etc/init.d</code></li>\n<li><code>~/.bashrc</code></li>\n</ul>\n</li>\n<li>\n<p>查看计划或定时任务</p>\n<ul>\n<li><code>crontab -l</code></li>\n</ul>\n</li>\n<li>\n<p><code>netstat -an</code>  /  <code>lsof</code>  查看进程端口占用</p>\n</li>\n</ul>\n<h1 id=\"windows应急响应\"><a class=\"anchor\" href=\"#windows应急响应\">#</a> Windows 应急响应</h1>\n<h2 id=\"文件分析-3\"><a class=\"anchor\" href=\"#文件分析-3\">#</a> 文件分析</h2>\n<ul>\n<li>\n<p>最近使用文件</p>\n<ul>\n<li><code>C:\\Documents and Settings\\Administrator\\Recent</code></li>\n<li><code>C:\\Documents and Settings\\Default User\\Recent</code></li>\n<li><code>%UserProfile%\\Recent</code></li>\n</ul>\n</li>\n<li>\n<p>系统日志分析</p>\n<ul>\n<li>事件查看器  <code>eventvwr.msc</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"用户分析-2\"><a class=\"anchor\" href=\"#用户分析-2\">#</a> 用户分析</h2>\n<ul>\n<li>查看是否有新增用户</li>\n<li>查看服务器是否有弱口令</li>\n<li>查看管理员对应键值</li>\n<li><code>lusrmgr.msc</code>  查看账户变化</li>\n<li><code>net user</code>  列出当前登录账户</li>\n<li><code>wmic UserAccount get</code>  列出当前系统所有账户</li>\n</ul>\n<h2 id=\"进程分析-3\"><a class=\"anchor\" href=\"#进程分析-3\">#</a> 进程分析</h2>\n<ul>\n<li>\n<p><code>netstat -ano</code>  查看是否打开了可疑端口</p>\n</li>\n<li>\n<p><code>tasklist</code>  查看是否有可疑进程</p>\n</li>\n<li>\n<p>分析开机自启程序</p>\n<ul>\n<li><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li>\n<li><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce</code></li>\n<li><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code></li>\n<li><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code></li>\n<li><code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\Run</code></li>\n<li><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li>\n<li><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code></li>\n<li><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code></li>\n<li><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code></li>\n<li><code>(ProfilePath)\\Start Menu\\Programs\\Startup</code>  启动项</li>\n<li><code>msconfig</code>  启动选项卡</li>\n<li><code>gpedit.msc</code>  组策略编辑器</li>\n</ul>\n</li>\n<li>\n<p>查看计划或定时任务</p>\n<ul>\n<li><code>C:\\Windows\\System32\\Tasks\\</code></li>\n<li><code>C:\\Windows\\SysWOW64\\Tasks\\</code></li>\n<li><code>C:\\Windows\\tasks\\</code></li>\n<li><code>schtasks</code></li>\n<li><code>taskschd.msc</code></li>\n<li><code>compmgmt.msc</code></li>\n</ul>\n</li>\n<li>\n<p>查看启动服务</p>\n<ul>\n<li><code>services.msc</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"日志分析-2\"><a class=\"anchor\" href=\"#日志分析-2\">#</a> 日志分析</h2>\n<ul>\n<li>事件查看\n<ul>\n<li><code>eventvwr.msc</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"其他\"><a class=\"anchor\" href=\"#其他\">#</a> 其他</h2>\n<ul>\n<li>查看系统环境变量</li>\n</ul>\n<h1 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h1>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTE0MA==\">黑客入侵应急分析手工排查</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5mcmVlYnVmLmNvbS9jb2x1bW4vMTQ3OTI5Lmh0bWw=\">取证入门 web 篇</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMjUyNA==\">Windows 系统安全事件应急响应</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTYzMg==\">企业安全应急响应</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly91cy1jZXJ0LmNpc2EuZ292L25jYXMvYWxlcnRzL2FhMjAtMjQ1YQ==\">Technical Approaches to Uncovering and Remediating Malicious Activity</span></li>\n</ul>\n",
            "tags": [
                "Windows",
                "应急响应",
                "流程",
                "Linux"
            ]
        }
    ]
}